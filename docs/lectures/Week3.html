<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 3 – Computational Social Science 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-bcb4737e8fbcf1e9dfc00b59f8305558.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-567b30ad711c8693efb6495feb883fb3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-bcb4737e8fbcf1e9dfc00b59f8305558.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked fullcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lectures/Before_week_1.html">Lectures</a></li><li class="breadcrumb-item"><a href="../lectures/Week3.html">Week 3</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Computational Social Science 2026</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/Before_week_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to take this class</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/Week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/Week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/Week3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Wiki</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wiki_pages/Schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wiki_pages/Assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wiki_pages/Evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Evaluation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wiki_pages/Groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Groups</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wiki_pages/Books.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Books</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lectures/Before_week_1.html">Lectures</a></li><li class="breadcrumb-item"><a href="../lectures/Week3.html">Week 3</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Week 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Today’s lecture has two main focuses:</p>
<p><strong>Part 1: Wrapping up Data Collection:</strong> We’re finishing our deep dive into data collection using the OpenAlex API. We’ll retrieve:</p>
<ul>
<li>information about the author, such as country and citation count.<br>
</li>
<li>information about publications, such as titles and abstracts.</li>
</ul>
<p>The goal is to become comfortable handling <strong>large, real-world datasets.</strong></p>
<p><em>A little warning</em>: In this week’s exercises you will retreive and process a <strong>large amount of data</strong>. If you find the process tedious and overwhelming at times, you are not alone! That’s a completely normal part of dealing with real data.</p>
<p>But don’t worry, I’ll guide you through step by step, and I’m always available to help, on Teams or in class. There are three simple rules for success:</p>
<ul>
<li>Follow thoroughly the step-by-step instructions.<br>
</li>
<li>Stay on top of your work weekly.<br>
</li>
<li>If you are stuck, come and talk to me during class/ask me via Teams.</li>
</ul>
<p><strong>Parts 2 and 3: Introduction to Data Visualization + Visualizing Distributions:</strong> Next, we shift to a lighter topic: <strong>Data Visualization.</strong> There will be some video lectures on general aspects of Data Visualization. Then we’ll start with visualizing histograms. You may feel already confident with plotting histograms, but we’ll explore new angles, especially when it comes to visualizing data that’s spread out across a wide range. You will start seeing the value of the data we’ve collected and starting to analyze it in practical ways.</p>
<p>This is probably the most intense lecture of the course in terms of coding. Once you are on the other side from this one, it will feel much smoother from there.</p>
<section id="part-1-wrapping-up-the-data-collection" class="level2">
<h2 class="anchored" data-anchor-id="part-1-wrapping-up-the-data-collection">Part 1: Wrapping up the data collection</h2>
<p>You’re now equipped to tackle more challenging tasks with the OpenAlex API. In this part of the course, we will build the <strong>Computational Social Science dataset step by step</strong>.</p>
<p>The key idea is that each dataset builds on the previous one. Think of this as a pipeline:<br>
- <strong>Stage 1:</strong> We start from a list of <em>IC2S2 authors</em> (from Week 2).<br>
- <strong>Stage 2:</strong> We collect their scientific papers.<br>
- <strong>Stage 3:</strong> From those papers, we identify their <em>co-authors</em> — researchers who wrote papers together with them — and then collect papers written by those co-authors.<br>
- <strong>Stage 4:</strong> Finally, we merge everything into one unified dataset representing the Computational Social Science field.</p>
<p><strong>Why do we collect data this way?</strong> Researchers do not attend all conferences, even if those conferences are relevant to their work. If we only included IC2S2 participants, we would capture only a visible subset of the field. For this reason, we expand our scope to include the collaborators of the IC2S2 authors — the <em>IC2S2 co-authors</em>. By moving one step outward through co-authorship links, we obtain a more realistic approximation of the Computational Social Science research community. In network science, this strategy is closely related to <a href="https://en.wikipedia.org/wiki/Snowball_sampling">snowball sampling</a>: starting from a seed set and expanding through observed connections.</p>
<p><strong>In Exercise 1</strong>, you will collect all research articles written by the IC2S2 authors (~1500 researchers). Even though this seems manageable, efficiency already matters — the code you write here will be reused in the next exercise.</p>
<p><strong>In Exercise 2</strong>, we expand to include the collaborators of the IC2S2 authors (the IC2S2 co-authors). This step significantly increases the dataset size. You’ll be managing <strong>many</strong> API requests here. This makes it crucial to write code that’s not just functional but also efficient.</p>
<p><strong>Overview of the Datasets we collect</strong> <img src="https://raw.githubusercontent.com/lalessan/comsocsci2026/master/images/schema_data.png" class="img-fluid" alt="Data collection pipeline"></p>
<div style="
  border-left: 6px solid #c0392b;
  background-color: #f8d7da;
  padding: 1em 1.2em;
  border-radius: 6px;
  max-width: 650px;
  margin: 1.5em auto;
  color: #222;
">
<p><strong>⚠ Before Exercise 1: Get an API key</strong></p>
<p>Starting <strong>February 13, 2026</strong>, an API key is required to use the OpenAlex API.</p>
<p>Steps for success:</p>
<ul>
<li><a href="https://openalex.org/login?redirect=/settings/api">Sign up</a> and authenticate.<br>
</li>
<li><a href="https://openalex.org/settings/api">Copy your API key</a>.<br>
</li>
<li>add <code>api_key=YOUR_KEY</code> to your API calls. When you use the <code>requests</code> library you can add it to your <code>params</code> dictionary.</li>
</ul>
</div>
<blockquote class="blockquote">
<p><strong>Exercise 1: Collecting Research Articles from IC2S2 Authors</strong></p>
<p>In this exercise, we’ll leverage the OpenAlex API to gather information on research articles authored by participants of the IC2S2 2025 conference, referred to as <em>IC2S2 authors</em>. <strong>Before you start, please ensure you read through the entire exercise.</strong></p>
<p><strong>Steps:</strong></p>
<ol type="1">
<li><p><strong>Retrieve Data:</strong> Start with the dataset of <em>IC2S2 authors</em> you collected in Week 2, Exercise 3 (called dataset D1 in the figure above). Use the OpenAlex API <a href="https://docs.openalex.org/api-entities/works">works endpoint</a> to fetch their research articles. For each article, retrieve the following details:</p>
<ul>
<li><em>id</em>: The unique OpenAlex ID for the work.</li>
<li><em>publication_year</em>: The year the work was published.</li>
<li><em>cited_by_count</em>: The number of times the work has been cited by other works.</li>
<li><em>author_ids</em>: The OpenAlex IDs for the authors of the work.</li>
<li><em>title</em>: The title of the work.</li>
<li><em>abstract_inverted_index</em>: The abstract of the work, formatted as an inverted index.</li>
</ul>
<p><strong>Important Note on Paging:</strong> By default, the OpenAlex API limits responses to 25 works per request. For more efficient data retrieval, I suggest to adjust this limit to 200 works per request. Even with this adjustment, you will need to implement pagination to access all available works for a given query. This ensures you can systematically retrieve the complete set of works beyond the initial 200. Find guidance on implementing pagination <a href="https://docs.openalex.org/how-to-use-the-api/get-lists-of-entities/paging#cursor-paging">here</a>.</p></li>
<li><p><strong>Data Storage:</strong> Organize the retrieved information into two Pandas DataFrames and save them to two files in a suitable format:</p>
<ul>
<li>Dataset D2: The <em>IC2S2 papers</em> dataset should include: <em>id, publication_year, cited_by_count, author_ids</em>.</li>
<li>Dataset D3: The <em>IC2S2 abstracts</em> dataset should include: <em>id, title, abstract_inverted_index</em>.</li>
</ul></li>
</ol>
<p><strong>Filters:</strong> To ensure the data we collect is relevant and manageable, apply the following filters:</p>
<ul>
<li>Only include <em>IC2S2 authors</em> with a total work count between 5 and 5,000.<br>
</li>
<li>Retrieve only works that have received more than 10 citations.<br>
</li>
<li>Limit to works authored by fewer than 10 individuals.<br>
</li>
<li>Include only works relevant to Computational Social Science (focusing on: Sociology OR Psychology OR Economics OR Political Science) AND intersecting with a quantitative discipline (Mathematics OR Physics OR Computer Science), as defined by their <a href="https://docs.openalex.org/api-entities/works/work-object#concepts">Concepts</a>. <em>Note</em>: here we only consider Concepts at <em>level=0</em> (the most coarse definition of concepts).</li>
</ul>
<p><strong>Efficiency Tips:</strong> Writing efficient code in this exercise is <strong>crucial</strong>. To speed up your process:</p>
<ul>
<li><strong>Apply filters directly in your request:</strong> When possible, use the <a href="https://docs.openalex.org/api-entities/works/filter-works">filter parameter</a> of the <em>works</em> endpoint to apply the filters above directly in your API request, ensuring only relevant data is returned. Learn about combining multiple filters <a href="https://docs.openalex.org/how-to-use-the-api/get-lists-of-entities/filter-entity-lists">here</a>.<br>
</li>
<li><strong>Bulk requests:</strong> Instead of sending one request for each author, you can use the <a href="https://docs.openalex.org/api-entities/works/filter-works">filter parameter</a> to query works by multiple authors in a single request. <em>Note: My testing suggests that can only include up to 25 authors per request.</em></li>
<li><strong>Use multiprocessing:</strong> Implement multiprocessing to handle multiple requests simultaneously. I highly recommmend <a href="https://joblib.readthedocs.io/en/stable/">Joblib’s Parallel</a> function for that, and <a href="https://tqdm.github.io/">tqdm</a> can help monitor progress of your jobs. Remember to stay within <a href="https://docs.openalex.org/how-to-use-the-api/rate-limits-and-authentication">the rate limit</a> of 100 requests per second.</li>
</ul>
<p>For reference, employing these strategies allowed me to fetch the data in about 30 seconds using 5 cores on my laptop. I obtained a dataset of approximately 25 MB (including both the <em>IC2S2 abstracts</em> and <em>IC2S2 papers</em> files).</p>
<p><strong>Data Overview and Reflection questions:</strong> Answer the following questions:</p>
<ul>
<li><strong>Dataset summary.</strong> How many works are listed in your Dataset D2 (<em>IC2S2 papers</em>) dataframe? How many unique researchers have co-authored these works?<br>
</li>
<li><strong>Efficiency in code.</strong> Describe the strategies you implemented to make your code more efficient. How did your approach affect your code’s execution time?<br>
</li>
<li><strong>Filtering Criteria and Dataset Relevance</strong> Reflect on the rationale behind setting specific thresholds for the total number of works by an author, the citation count, the number of authors per work, and the relevance of works to specific fields. How do these filtering criteria contribute to the relevance of the dataset you compiled? Do you believe any aspects of Computational Social Science research might be underrepresented or overrepresented as a result of these choices?</li>
</ul>
</blockquote>
<div style="
  border:1px solid #5b2ca0;
  border-radius:10px;
  margin:20px 0;
  background:#ede0ff;
  padding:22px;
  color:#2b003d;
  line-height:1.6;
  max-width:100%;
  box-sizing:border-box;
  overflow-wrap:break-word;
">
<p>
To maximise learning and ensure a correct solution, avoid LLMs to solve the exercise. As ususal it is important to solve the exercise in a “modular” way. Start by making an API request for a single author, inspect the response carefully, and try a few different names to discover potential issues and address them.<br>
Once you’re satisfied with your approach, work on scaling up the solution and run the requests for many authors. If you’d like, once you have a working code, you can ask an LLM for suggestions on how to improve efficiency.
</p>
<blockquote class="blockquote">
<p><strong>Exercise 2: Collecting Data from IC2S2 Co-Authors</strong> In this exercise, we aim to collect detailed information on the co-authors of the IC2S2 authors and their publications. You’ll find that the code you developed previously can be efficiently reused here. <strong>Please ensure you read the entire exercise before beginning.</strong></p>
<p><strong>Steps:</strong></p>
<ol type="1">
<li><p><strong>Retreive information about IC2S2 co-authors.</strong> Start with the unique author IDs in the dataset D2 ( <em>IC2S2 papers</em>) you compiled in Exercise 1 above. Use the <a href="https://docs.openalex.org/api-entities/authors">OpenAlex API authors endpoint</a> for each author, to collect the following information:</p>
<ul>
<li><em>display_name</em>: The name of the author as a single string.</li>
<li><em>works_api_url</em>: A URL that will get you a list of all this author’s works.</li>
<li><em>h_index</em> : The h-index for this author.</li>
<li><em>works_count</em>: The number of Works this this author has created.</li>
<li><em>country_code</em>: The country code of their last known institution</li>
</ul>
<p><strong>Important:</strong> Exclude the <em>IC2S2 authors</em> from this query since you already have their data. <strong>Hint:</strong> Remember you can collect data in bulks.</p></li>
<li><p><strong>Data Storage</strong> Compile the retrieved information into a Pandas DataFrame and save it. This is dataset D4 (<em>IC2S2 co-authors</em>). Choose an appropriate file format for storage.</p></li>
<li><p><strong>Retreive works from IC2S2 co-authors.</strong> Using the same procedure as in Exercise 1, gather data on the works by IC2S2 co-authors to create Dataset D5 (<em>co-authors abstracts</em>) and Dataset D6 (<em>co-authors papers</em>). Save the two dataframes to files. You can use exactly the same code you used in Exercise 1, with two small adjustments:</p>
<ul>
<li>Exclude from this query the works by <em>IC2S2 authors</em>, since you already have them.</li>
<li>When saving the <em>co-authors papers</em> dataframe: Include in the author_ids field only those authors who are either <em>IC2S2 authors</em> or <em>IC2S2 co-authors</em>. We just discard all other authors.</li>
</ul></li>
<li><p><strong>Combine the data from authors and co-authors.</strong> We will now create our final dataframes and save them to file:</p>
<ul>
<li><strong>The CSS Authors dataset (D1+D4)</strong>. Concatenate the <em>IC2S2 authors</em> (Dataset D1) dataset with the <em>IC2S2 co-authors</em> dataset (Dataset D4). There should not be duplicates here, but if there is any, remove them.</li>
<li><strong>The CSS Papers dataset (D2+D5)</strong>. Concatenate the <em>IC2S2 papers</em> (Dataset D2) with the <em>co-authors papers</em> dataset (Dataset D5), then drop duplicate works. Remove papers with only one author (we are interested in collaborative works here).</li>
<li><strong>The abstracts dataset (D3+D6)</strong>. Concatenate the <em>IC2S2 abstracts</em> dataset (Dataset D3) with the <em>IC2S2 co-authors abstracts</em> (Dataset D6), then drop duplicates.</li>
</ul>
<p><em>Note:</em> You can delete the intermidiate files you have saved, we won’t use them from now on.</p></li>
</ol>
<p><strong>Filters:</strong></p>
<ul>
<li>Apply the same filtering criteria as in Exercise 1 above to maintain consistency and relevance in the data collected.</li>
</ul>
<p><strong>Efficiency Tips:</strong></p>
<ul>
<li><p>Implement the efficiency enhancements suggested in Exercise 1. Here, they are even more crucial here due to the larger volume of data. For reference, employing these strategies allowed me to perform step 1 above in about 1:40 minutes and step 3 in 10:48 minutes using 5 cores on my laptop. I obtained a dataset of approximately 383 MB.</p></li>
<li><p>Here are additional tips if you find that, even after optimizing, the code still takes long to run:</p>
<ul>
<li><em>Teamwork</em>: Consider splitting the API requests among your team members.<br>
</li>
<li><em>Leave the computer to it</em>: Ensure your laptop is plugged into power and that sleep mode is disabled before you start running your code. Then, take a step back. You can stretch, grab a coffee, or get a snack, and just leave your computer fetch the data. Personally, I find it satisfying to let the machine work while I do something else. Coming back to find all tasks completed feels just great. And won’t make the whole process faster anyways :)</li>
</ul></li>
</ul>
</blockquote>
<blockquote class="blockquote">
<p><strong>Exercise 3: Data Overview and Reflection questions:</strong> Answer the following questions:</p>
<ul>
<li><strong>Dataset summary.</strong> What is the final length of your “CSS Authors”, “CSS Papers” and “CSS Abstracts” datasets?<br>
</li>
<li><strong>Efficiency in code.</strong> Describe the strategies you implemented to make your code more efficient. How did your approach affect your code’s execution time?<br>
</li>
<li><strong>Reflection</strong>. Consider the instruction (in step 3 above) to include only <em>IC2S2 authors</em> or <em>IC2S2 co-authors</em> in the <em>author_ids</em> field of the <em>co-authors papers</em> dataframe. Why do you think I asked you to apply this specific filtering criterion? Discuss how limiting the dataset to these authors affects the dataset’s relevance and integrity.</li>
</ul>
</blockquote>
<p><strong>Go on DTU Learn and fill in the survey <em><a href="https://learn.inside.dtu.dk/d2l/lms/survey/user/surveys_list.d2l?ou=187754">Week 3 - The final dataset</a>.</em></strong> This is a way for me to check/ensure that you as a class are up to speed with the material.</p>
<section id="part-2-intro-to-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="part-2-intro-to-data-visualization">Part 2: Intro to Data Visualization</h2>
<p>Great job getting all the data together. That was quite some effort.<br>
Now comes the most interesting part: exploring the data. This is an opportunity to understand the field of Computational Social Science using data to apply the methods we will develop throughout the course.</p>
<p>Before we begin the analysis, we’re going to talk about Data Visualization. In the two videos below, I will: (i) introduce general concepts on Data Visualization and (ii) present a few tips and techniques to improve the visual quality of your plots in Python.</p>
<p><strong>In the assignments, I expect your plots to be informative, well-designed and clear to intepret. These aspects will be part of the evaluation.</strong></p>
<blockquote class="blockquote">
<ul>
<li><em>Video Lecture</em>: <a href="https://www.youtube.com/watch?v=oLSdlg3PUO0">Intro to Data Visualization</a></li>
</ul>
</blockquote>
<div id="cell-14" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> YouTubeVideo</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>YouTubeVideo(<span class="st">"oLSdlg3PUO0"</span>,width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">450</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">

        <iframe width="800" height="450" src="https://www.youtube.com/embed/oLSdlg3PUO0" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
<p>Before even starting visualizing some cool data, I just want to give a few more practical tips for making good plots in matplotlib. Unless you feel like you are already a pro-visualizer, those should be pretty useful to make your plots look much nicer. Paying attention to details can make an incredible difference when we present our work to others.</p>
<p><strong>Note</strong>: there are many Python libraries to make visualizations. For this course, we will use matplotlig, which is one of the most widely used and flexible visualization libraries.</p>
<blockquote class="blockquote">
<p><em>Video Lecture</em>: <a href="https://www.youtube.com/watch?v=sdszHGaP_ag">How to improve your plots</a></p>
</blockquote>
<div id="cell-17" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> YouTubeVideo</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>YouTubeVideo(<span class="st">"sdszHGaP_ag"</span>,width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">450</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">

        <iframe width="800" height="450" src="https://www.youtube.com/embed/sdszHGaP_ag" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
</section>
<section id="part-3-visualizing-distributions" class="level2">
<h2 class="anchored" data-anchor-id="part-3-visualizing-distributions">Part 3: Visualizing distributions</h2>
<p>Relying solely on summary statistics like the mean, median, and standard deviation to understand your dataset can sometimes be misleading. It’s very good practice, to begin your analysis by visualizing the data distribution. Observing the probability distribution of data points can reveal a wealth of insights.</p>
<p>The problem is that real-world datasets often cover a wide range of values, spanning several orders of magnitude. Hence, basic methods of plotting histograms may not effectively represent these datasets. However, there are techniques to address this challenge and enhance visualization.</p>
<p>In the video lecture below, I demonstrate how to plot histograms for datasets with significant heterogeneity. The techniques are shown using two examples: a financial dataset on stock prices and returns, and data on the number of comments posted by Reddit users. But these methods are universally applicable. You can use them to visualize any type of data.</p>
<blockquote class="blockquote">
<p><em>Video Lecture</em>: <a href="https://www.youtube.com/watch?v=UpwEsguMtY4">Plotting histograms and distributions</a></p>
</blockquote>
<div id="cell-20" class="cell" data-execution_count="186">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>YouTubeVideo(<span class="st">"UpwEsguMtY4"</span>,width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">450</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="186">

        <iframe width="800" height="450" src="https://www.youtube.com/embed/UpwEsguMtY4" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
<blockquote class="blockquote">
<p><strong>Exercise 4: Analyzing Author Citations</strong> In this exercise, we aim to explore the distribution of citations per author within the field of Computational Social Science. Our objectives are twofold:</p>
<ul>
<li><em>Learn to Plot Distributions:</em> We’ll tackle the challenge of visualizing distributions for heterogeneous data, a common scenario in Computational Social Science.<br>
</li>
<li><em>Investigate Author Recognition:</em> We’ll analyze how recognition (measured in citations) varies for Computational Social Scientists from different countries.</li>
</ul>
<p><strong>Dataset:</strong> Use the “CSS Authors dataset” you prepared in Exercise 2 above.</p>
<p><strong>Tasks:</strong> 1. <strong>Data Preparation:</strong>.</p>
<ul>
<li>Extract the total number of citations for each author from the dataset and store this information in an array.</li>
</ul>
<ol start="2" type="1">
<li><p><strong>Plotting the Overall Citation Distribution:</strong>.</p>
<ul>
<li><p>Use <a href="https://numpy.org/doc/stable/reference/generated/numpy.histogram.html"><code>numpy.histogram</code></a> to create a histogram of citations per author. Consider the following when plotting your histogram:</p>
<ul>
<li><strong>Number of bins:</strong> The default behavior of <code>numpy.histogram</code> is to create 10 equally spaced bins. However, you should customize this to suit your data. Experiment with different numbers and sizes of bins to find the most informative visualization. Too few bins may oversimplify your data, while too many can result in a fragmented appearance.<br>
</li>
<li><strong>Linear vs.&nbsp;Logarithmic Binning</strong> Choose the approrpiate binning:
<ul>
<li>Use <em>logarithmic binning</em> for heterogeneous data that has many extreme values (usuall in the right tail), creating bins with <code>numpy.logspace</code>.<br>
</li>
<li>Else, use <em>linear binning</em>, creating bins with <code>numpy.linspace</code>.<br>
</li>
</ul></li>
<li><strong>Normalization</strong> Where appropriate, you can convert your histogram into a Probability Density Function:
<ul>
<li>set the <code>density=True</code> argument in <code>numpy.histogram</code>. This normalizes the histogram so the area under the curve equals 1, providing insights into the probability distribution of citations.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Comparative Histograms by Country:</strong></p>
<ul>
<li>Identify the top 5 countries by the number of authors. For each of these countries, plot the distribution of ciations per author (as a line plot). Overlay these histograms on the same figure for comparison.</li>
</ul></li>
<li><p><strong>Reflection questions:</strong></p>
<ul>
<li>Did you choose linear or logarithmic binning for the histograms in tasks 2 and 3? Why?<br>
</li>
<li>Did you normalize the histograms? why? Describe in your own words the difference between normalized and non-normalized histograms.<br>
</li>
<li>How does author recognitation, as captured by the total number of citations, varies among authors in the whole dataset and in the selected countries?</li>
</ul></li>
</ol>
</blockquote>
<div style="
  border:1px solid #5b2ca0;
  border-radius:10px;
  margin:20px 0;
  background:#ede0ff;
  padding:22px;
  color:#2b003d;
  line-height:1.6;
  max-width:100%;
  box-sizing:border-box;
  overflow-wrap:break-word;
">
<p>
Here, I strongly recommend you fully solve the exercise by yourself. Once you have a working solution, you can play with an LLM to improve the visualizations and make them look nicer.
</p>


</div>
</section>
</div>
</section>

</main> <!-- /main -->
<script>
document.addEventListener("DOMContentLoaded", async function () {
  const path = window.location.pathname;

  if (path.endsWith(".html")) {
    const ipynb = path.replace(".html", ".ipynb");

    try {
      const response = await fetch(ipynb, { method: "HEAD" });

      if (response.ok) {
        const filename = ipynb.split("/").pop();

        const btn = document.createElement("a");
        btn.href = ipynb;
        btn.textContent = "⬇️ Download Notebook";
        btn.className = "btn btn-sm btn-outline-primary";
        btn.setAttribute("download", filename);

        // Find Quarto page header
        const header = document.querySelector(".quarto-title-block");

        if (header) {
          const container = document.createElement("div");
          container.style.textAlign = "right";
          container.style.marginTop = "-10px";
          container.appendChild(btn);
          header.appendChild(container);
        }
      }
    } catch (e) {}
  }
});
</script>
qu
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>